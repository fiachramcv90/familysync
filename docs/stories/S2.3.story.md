# <!-- Powered by BMAD‚Ñ¢ Core -->

# Story S2.3: Code Cleanup & Technical Debt

## Status
‚ö†Ô∏è **IMPORTANT** - Not Started

## Story
**As a** developer,  
**I want** a clean, organized codebase without technical debt from debugging and development,  
**so that** the project is ready for feature development with a solid foundation.

## Acceptance Criteria

1. **Remove or organize debug API endpoints** properly in the codebase
2. **Commit or remove untracked files** appropriately based on their purpose
3. **Clean up unused imports and dead code** throughout the project
4. **Update .gitignore** for proper test artifacts and temporary files
5. **Ensure clean git status** with no unnecessary untracked files
6. **Organize project structure** according to established patterns

## Tasks / Subtasks

- [ ] **Audit and clean debug API endpoints** (AC: 1)
  - [ ] Review debug endpoints in `/api/debug-*` directories
  - [ ] Remove temporary debugging endpoints not needed in production
  - [ ] Move useful debug endpoints to proper development utilities
  - [ ] Document any debugging tools that should be retained
  - [ ] Ensure no debug code affects production builds
- [ ] **Handle untracked files appropriately** (AC: 2, 5)
  - [ ] Review `playwright.deploy.config.ts` and decide if it should be committed
  - [ ] Organize files in `src/app/api/debug-env/` directory
  - [ ] Clean up test results files (`.last-run 2.json`)
  - [ ] Remove temporary screenshots and debug artifacts
  - [ ] Commit files that should be version controlled
- [ ] **Code cleanup and optimization** (AC: 3)
  - [ ] Remove unused imports across all TypeScript/JavaScript files
  - [ ] Delete commented-out code that's no longer needed
  - [ ] Clean up console.log statements not needed for production
  - [ ] Remove temporary variables and debugging code
  - [ ] Optimize imports and organize them consistently
- [ ] **Update .gitignore and project configuration** (AC: 4)
  - [ ] Add patterns for test artifacts (test-results, playwright-report)
  - [ ] Ignore temporary debugging files and screenshots
  - [ ] Add patterns for build artifacts and cache files
  - [ ] Ensure environment files are properly ignored
  - [ ] Review and update editor-specific ignore patterns
- [ ] **Verify project structure compliance** (AC: 6)
  - [ ] Ensure components are in correct directories
  - [ ] Verify API routes follow proper organization
  - [ ] Check that test files are properly located
  - [ ] Confirm documentation is up to date
  - [ ] Validate that naming conventions are followed

## Dev Notes

### Current Technical Debt Identified

**Untracked Files:**
```bash
playwright.deploy.config.ts           # Decide: commit or remove?
src/app/api/debug-env/               # Debug endpoint directory
test-results/.last-run 2.json       # Test artifacts to ignore
```

**Debug Code Accumulation:**
- Multiple debug endpoints created during authentication development
- Temporary debugging statements and console.logs
- Test screenshots and debugging artifacts
- Unused imports from development iterations

### Cleanup Strategy

**Debug Endpoints Review:**
1. **Keep**: Useful development tools (environment checks, health endpoints)
2. **Remove**: Temporary debugging endpoints specific to recent auth work
3. **Document**: Any debug tools that should be retained for future development

**File Organization:**
1. **Commit**: Configuration files needed for deployment/testing
2. **Remove**: Temporary files and test artifacts
3. **Ignore**: File patterns that shouldn't be tracked

### Architecture Compliance

**Project Structure Standards:**
```
src/
‚îú‚îÄ‚îÄ app/                    # Next.js app router
‚îÇ   ‚îú‚îÄ‚îÄ api/               # API routes (organized, no temp debug)
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/         # Dashboard pages
‚îÇ   ‚îî‚îÄ‚îÄ auth/              # Authentication pages
‚îú‚îÄ‚îÄ components/            # React components (organized by feature)
‚îú‚îÄ‚îÄ lib/                   # Utilities and configuration
‚îú‚îÄ‚îÄ hooks/                 # Custom React hooks
‚îî‚îÄ‚îÄ stores/                # State management
```

**Code Quality Standards:**
- No unused imports
- Consistent import organization
- No commented-out code blocks
- Minimal console.log statements (only for error handling)
- Proper TypeScript types throughout

### Dependencies
- **Requires**: All Phase 1 stories completed (S1.1, S1.2, S1.3) for clean foundation
- **Benefits**: All future development work
- **Low Risk**: Cleanup work unlikely to break functionality

## Testing

### Test Location Standards
- Verify no tests broken by cleanup
- Ensure test artifacts properly ignored
- Confirm build process unaffected

### Cleanup Verification
```bash
# Commands to verify cleanup success:
npm run lint              # Should pass with no new issues
npm run type-check        # Should pass (maintained from S1.3)
npm run build             # Should complete successfully
git status                # Should show clean working directory
```

### Quality Checks
- [ ] No unused imports detected by linter
- [ ] No commented-out code blocks remain
- [ ] Console.log statements only for legitimate logging
- [ ] All files properly organized in correct directories
- [ ] .gitignore covers all temporary and build files

## Security Review

### Code Security Cleanup
- [ ] Remove any accidentally committed secrets or keys
- [ ] Ensure debug endpoints don't expose sensitive information
- [ ] Verify no temporary debugging bypasses remain
- [ ] Clean up any hardcoded values that should be configurable

### Build Security
- [ ] Confirm no debug code affects production builds
- [ ] Ensure development-only code properly excluded
- [ ] Verify environment-specific configurations are correct

## Performance Impact

### Cleanup Benefits
- Reduced bundle size from removed dead code
- Faster builds without unnecessary files
- Improved development experience with organized code
- Better maintainability for future development

## Documentation Updates

### Documentation Cleanup
- [ ] Update README if any setup instructions changed
- [ ] Remove outdated comments and documentation
- [ ] Ensure code comments are accurate and useful
- [ ] Update any development workflow documentation

## Definition of Done

**‚úÖ Before moving this story to "Ready for Review", the developer MUST verify:**

### Code Quality Gates
- [ ] **Linter passes**: `npm run lint` completes with 0 errors and 0 warnings
- [ ] **Type check passes**: `npm run type-check` completes with 0 errors
- [ ] **Build succeeds**: `npm run build` completes successfully without errors
- [ ] **Clean git status**: `git status` shows clean working directory

### Code Cleanup Requirements
- [ ] **Debug endpoints removed**: All temporary `/api/debug-*` endpoints cleaned up
- [ ] **Unused imports eliminated**: No unused imports detected by linter
- [ ] **Dead code removed**: No commented-out code blocks remain
- [ ] **Console.log cleanup**: Only production-appropriate logging statements remain
- [ ] **File organization**: All files in correct directories per project structure

### File Management
- [ ] **Untracked files resolved**: All untracked files either committed or removed
- [ ] **.gitignore updated**: Test artifacts and temporary files properly ignored
- [ ] **Project structure compliance**: Components, API routes, tests properly organized
- [ ] **Configuration files**: All config files committed or appropriately ignored

### Testing Requirements
- [ ] **All tests pass**: `npm test` passes after cleanup
- [ ] **No broken tests**: Cleanup doesn't break existing functionality
- [ ] **Test artifacts ignored**: Test results properly excluded from git

### Deployment Verification
- [ ] **Preview deployment**: Clean code deploys successfully to preview
- [ ] **Smoke test subset**: Run cleanup verification tests on preview:
  ```bash
  # Must pass on preview deployment:
  npx playwright test --grep="basic functionality|core features|navigation"
  ```
- [ ] **Performance maintained**: No performance regression from cleanup
- [ ] **Functionality intact**: All features work exactly as before cleanup

### Security Review
- [ ] **No exposed secrets**: No accidentally committed API keys or credentials
- [ ] **Debug security**: No debug endpoints expose sensitive information
- [ ] **Configuration security**: Environment-specific configs properly handled

### Quality Standards
- [ ] **Code organization**: Consistent file and directory structure
- [ ] **Naming conventions**: All files follow project naming standards
- [ ] **Documentation accuracy**: Comments and docs reflect actual code
- [ ] **Development experience**: Clean, organized codebase for future development

### Git Workflow Requirements
- [ ] **Feature branch**: Work completed on feature branch (e.g., `feature/S2.3-code-cleanup`)
- [ ] **Atomic commits**: Each commit represents a single logical change with clear message
- [ ] **Commit message format**: Follow conventional commits (e.g., `chore: remove debug endpoints and clean code`)
- [ ] **No direct main commits**: All changes via pull request, never commit directly to main
- [ ] **Clean git history**: Squash/rebase commits if needed for clean history
- [ ] **Pre-commit hooks**: All pre-commit checks pass before each commit
- [ ] **Branch up to date**: Feature branch rebased/merged with latest main before PR
- [ ] **File removal tracking**: Git properly tracks deleted files and directories
- [ ] **Gitignore updates**: Updated .gitignore committed with cleanup changes
- [ ] **No accidental deletions**: Verify all file removals are intentional
- [ ] **Clean working directory**: `git status` shows only intended changes
- [ ] **Organized commits**: Separate commits for different types of cleanup (files, code, docs)
- [ ] **Git status clean**: Final `git status` shows clean working directory before PR
- [ ] **Descriptive PR**: Pull request has clear title, description, cleanup summary, and links to story

**üìã DEPENDENCY**: Requires all Phase 1 stories (S1.1, S1.2, S1.3) for stable foundation.

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-09-10 | 1.0 | Initial code cleanup and technical debt story | BMad Orchestrator |

## Priority Classification

**Epic**: Project Stabilization  
**Phase**: 2 - Foundation Improvements  
**Priority**: P1 - Important  
**Estimated Effort**: 1-2 hours  
**Assigned Agent**: `maintenance` specialist  
**Risk**: Low - Cleanup work with minimal functionality impact  
**Dependencies**: All Phase 1 stories (S1.1, S1.2, S1.3) for stable foundation